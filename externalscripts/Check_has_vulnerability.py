#!/usr/bin/env python
# -*- coding:utf-8 -*-

import argparse
import json

def get_has_vulnerability(socket_type, port, json_data):
    for item in json_data["current_opened_port_value"]:
        if item["socket_type"] == socket_type and item["port"] == port:
            return int(item["has_vulnerability"])
    return 0

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Get has_vulnerability value from JSON data")
    parser.add_argument("socket_type", type=str, help="Socket type (e.g. tcp)")
    parser.add_argument("port", type=int, help="Port number")
    args = parser.parse_args()

    with open("/tmp/criminalip_cachefile.txt") as f:
        json_data = json.load(f)

    has_vulnerability = get_has_vulnerability(args.socket_type, args.port, json_data)
    print(has_vulnerability)
